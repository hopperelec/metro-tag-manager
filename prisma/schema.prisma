generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["relationJoins"]
}

datasource db {
  provider = "sqlite"
  url      = "file:./tags.db"
}

model Media {
  id Int @id @default(autoincrement())

  path     String @unique
  size     BigInt? // in bytes, null means doesn't exist
  duration Int? // in seconds, 0 means image, null means unknown
  width    Int? // in pixels, null means unknown
  height   Int? // in pixels, null means unknown

  contextTags ContextTag[]
  trainTags   TrainTag[]
}

model ContextTag {
  id Int @id @default(autoincrement())

  mediaId Int
  media   Media @relation(fields: [mediaId], references: [id], onDelete: Cascade)

  tag String
}

model TrainTag {
  id Int @id @default(autoincrement())

  mediaId Int
  media   Media @relation(fields: [mediaId], references: [id], onDelete: Cascade)

  trainId Int
  tag     String

  @@unique([mediaId, trainId, tag])
}
